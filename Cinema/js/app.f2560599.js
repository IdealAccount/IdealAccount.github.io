(function(e){function t(t){for(var r,s,i=t[0],o=t[1],l=t[2],p=0,f=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&f.push(c[s][0]),c[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var o=n[i];0!==c[o]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},c={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=o;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"18f2":function(e,t,n){},"1b05":function(e,t,n){},"1ed9":function(e,t,n){"use strict";var r=n("de01"),c=n.n(r);c.a},"24bb":function(e,t,n){"use strict";var r=n("b804"),c=n.n(r);c.a},3645:function(e,t,n){"use strict";var r=n("3e33"),c=n.n(r);c.a},"3e33":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("the-wrapper",[n("screen-list"),n("transition",[n("v-loader")],1)],1)],1)},a=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"container"},[e._t("default")],2)])},i=[],o={},l=o,u=(n("1ed9"),n("2877")),p=Object(u["a"])(l,s,i,!1,null,null,null),f=p.exports,d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"container-scrollable"},[n("transition-group",{staticClass:"screen-list",attrs:{tag:"ul",name:"screen-appear"}},e._l(e.GET_MESSAGES,(function(t,r){return n("li",{key:r,staticClass:"screen-list__screen"},[t?n("screen-item",{key:r,attrs:{screen:t,index:r}}):e._e(),t.answer?n("div",{staticClass:"msg-box msg-answer slide-left"},[n("span",{domProps:{innerHTML:e._s(t.answer)}})]):e._e()],1)})),0)],1),n("v-input")],1)},b=[],m=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-container"},[n("div",{key:"screen_one",staticClass:"row"},[e.media?n("div",{staticClass:"screen-bg",class:[{"is-loading":e.loading},e.animClass]},[e.type_img?n("img",{attrs:{src:e.imgSrc}}):e.type_video?n("iframe",{staticClass:"screen-bg__video",staticStyle:{height:"34vmax"},attrs:{src:e.video_src,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}}):e._e()]):e._e()]),n("div",{key:"screen_two",staticClass:"row"},[e.msgOut?n("div",{key:e.screen.id,staticClass:"msg-box msg-question slide-right",style:e.customize},[n("div",{staticClass:"msg-inner",domProps:{innerHTML:e._s(e.msgOut)}})]):e._e()]),n("div",{key:"screen_three",staticClass:"row"},[e.buttons?n("div",{staticClass:"btn-group"},e._l(e.buttons,(function(t,r){return n("v-button",{key:r,staticClass:"slide-top",style:[t.customize,{animationDelay:120*r+"ms"}],attrs:{disabled:e.$store.state.loading||e.screen.clicked},domProps:{innerHTML:e._s(e.tagReplacer(t.text))},on:{click:function(n){return e.next(e.screen,t)}}})})),1):e._e()])])},O=[],v=(n("7f7f"),n("6762"),n("2fdb"),n("a481"),n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"screen-btn",attrs:{type:"button"},on:{click:function(t){return e.$emit("click",t)}}},[n("span",[e._t("default")],2)])}),h=[],_={},E=_,y=(n("7785"),Object(u["a"])(E,v,h,!1,null,null,null)),S=y.exports,w=n("2f62");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(m["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={components:{VButton:S},props:{screen:Object,index:Number},data:function(){return{imgSrc:null,loading:!1,answer:null}},mounted:function(){this.imgLoading()},computed:A({},Object(w["c"])(["GET_ANSWER","VISIBLE"]),{media:function(){return!!this.screen.attacment},video_src:function(){return"youtube"===this.screen.attacment.type?"https://www.youtube.com/embed/".concat(this.screen.attacment.data):"vimeo"===this.screen.attacment.type?"https://player.vimeo.com/video/".concat(this.screen.attacment.data):void 0},buttons:function(){return!!this.screen.buttons.length&&this.screen.buttons.map((function(e){return Object.assign(e,{customize:{background:"#".concat(e.customize.background),color:"#".concat(e.customize.color)}})}))},customize:function(){return{background:"#".concat(this.screen.customize.background),color:"#".concat(this.screen.customize.color)}},type_img:function(){return!!this.screen.attacment&&"image"===this.screen.attacment.type},type_video:function(){return!!this.screen.attacment&&"vimeo"===this.screen.attacment.type},msgOut:function(){var e=this.screen.text;return e=e.replace(/\n/gm,"<br>"),this.tagReplacer(e)},animClass:function(){return 0===this.index?"appear-tada":"appear"}}),methods:A({},Object(w["b"])(["setAnswer","nextMessage","scroll","setVariable"]),{tagReplacer:function(e){if(e)return e.includes("[bold]")&&(e=e.replace("[bold]","<strong>").replace("[/bold]","</strong>")),e.includes("[em]")&&(e=e.replace("[em]","<em>").replace("[/em]","</em>")),e},next:function(e,t){var n=t.action,r=t[n],c=this.tagReplacer(t.text);"link"===n&&window.open(r);var a={name:t.variable.name,value:t.variable.value};this.nextMessage([e,a,c,r,n]),e.clicked=!0},imgLoading:function(){var e=this;if(!this.screen.attacment)return!1;this.loading=!0,this.imgSrc=this.screen.attacment.thumbnail,setTimeout((function(){e.imgSrc=e.screen.attacment.data,e.loading=!1}),400)}})},C=P,L=(n("b21f"),Object(u["a"])(C,g,O,!1,null,null,null)),T=L.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"msg-input",class:{disabled:!e.LOCK},on:{keypress:function(t){return e.sendValue(t)}}},[n("div",{staticClass:"msg-icon-smile"},[n("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[n("g",[n("g",[n("path",{attrs:{d:"M256,0C114.848,0,0,114.848,0,256s114.848,256,256,256s256-114.848,256-256S397.152,0,256,0z M256,480\n\t\t\tC132.512,480,32,379.52,32,256S132.512,32,256,32s224,100.48,224,224S379.488,480,256,480z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M352,128c-35.296,0-64,28.704-64,64c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16c0-17.632,14.336-32,32-32\n\t\t\ts32,14.368,32,32c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16C416,156.704,387.296,128,352,128z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M160,128c-35.296,0-64,28.704-64,64c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16c0-17.632,14.336-32,32-32\n\t\t\ts32,14.368,32,32c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16C224,156.704,195.296,128,160,128z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M438.016,294.336c-3.008-4-7.744-6.336-12.736-6.336H86.72c-4.992,0-9.728,2.336-12.736,6.336\n\t\t\tc-3.04,4-4,9.184-2.656,14.016C94.464,390.56,170.4,448,256,448s161.536-57.44,184.672-139.648\n\t\t\tC442.016,303.52,441.056,298.336,438.016,294.336z M256,416c-64.032,0-121.568-38.56-146.624-96h293.248\n\t\t\tC377.568,377.44,320.032,416,256,416z"}})])]),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g")])]),n("div",{staticClass:"msg-input__field"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"input",attrs:{type:"text",placeholder:e.PLACE_HOLDER,disabled:e.LOCK},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}})]),n("button",{staticClass:"msg-input__btn",attrs:{disabled:e.LOCK},on:{click:function(t){return e.sendValue(t)}}},[n("svg",{attrs:{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"}},[n("path",{attrs:{fill:"#3b85f5","fill-opacity":"1",d:"M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"}})])])])},M=[];function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){Object(m["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={props:{screenVariable:Object},data:function(){return{value:null,answer:null}},watch:{LOCK:function(){var e=this;this.LOCK||setTimeout((function(){return e.$refs.input.focus()}),200)}},computed:D({},Object(w["c"])(["LOCK","PLACE_HOLDER","GET_MESSAGE"])),methods:D({},Object(w["b"])(["setName","setAnswer","NEXT_STEP","nextMessage","setAnchor","setVariable"]),{sendValue:function(e){if("click"===e.type||"keypress"===e.type&&(13===e.keyCode||32===e.keyCode))if(this.value){var t=this.GET_MESSAGE,n=this.value,r=t.variable.next,c="anchor",a={name:t.variable.name,value:this.value};this.nextMessage([t,a,n,r,c]),this.value=""}else if(!this.value)return alert("Введите сообщение")}})},I=G,R=(n("bdbb"),Object(u["a"])(I,x,M,!1,null,null,null)),N=R.exports;function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(m["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H={name:"ScreenList",components:{ScreenItem:T,VInput:N},data:function(){return{}},mounted:function(){this.DOWNLOAD_MESSAGE_FROM_API([])},computed:z({},Object(w["c"])(["SCREEN_LIST","GET_ANSWER","GET_MESSAGES","VISIBLE"]),{answer:function(){return this.GET_MESSAGES.answer}}),methods:z({},Object(w["b"])(["GET_MESSAGES_FROM_API","DOWNLOAD_MESSAGE_FROM_API","scroll"]))},W=H,$=(n("24bb"),Object(u["a"])(W,d,b,!1,null,null,null)),K=$.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.LOADING_ON?n("div",{staticClass:"loader-row"},[e._m(0)]):e._e()},U=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"loader"},[n("li",{staticClass:"loader-inner-1"}),n("li",{staticClass:"loader-inner-2"}),n("li",{staticClass:"loader-inner-3"})])}];function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){Object(m["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q={data:function(){return{loading:!1}},computed:X({},Object(w["c"])(["LOADING_ON"]))},J=q,Q=(n("3645"),Object(u["a"])(J,B,U,!1,null,null,null)),Y=Q.exports,Z={name:"app",components:{TheWrapper:f,ScreenList:K,VLoader:Y}},ee=Z,te=(n("5c0b"),Object(u["a"])(ee,c,a,!1,null,null,null)),ne=te.exports,re=(n("8449"),n("768b")),ce=n("bc3a"),ae=n.n(ce);r["a"].use(w["a"]);var se=new w["a"].Store({state:{lockInput:!0,placeholder:"Ваше сообщение",loading:!1,name:null,messages:[],anchor_global:"",user_id:"777-000987",answer:null,method:"main",anchor:"cinema",action:"",role:""},mutations:{SET_VARIABLE:function(e,t){e[t.name]=t.value,e.variable=t.name},NEXT_MESSAGE_URL:function(e,t){var n=Object(re["a"])(t,2),r=n[0],c=n[1];e[c]=r,e.action=c,"anchor"===c?e.anchor=r:"anchor_global"===c&&(e.anchor_global=r,e.role=e.anchor_global)},SET_ANCHOR:function(e,t){e.anchor=t},SET_MESSAGES_TO_STATE:function(e,t){t.visible=!1,e.messages.length<1?e.messages.push(t):e.messages.includes(t)||e.messages.push(t)},LOCK_INPUT:function(e,t){e.loading&&(e.lockInput=!0),e.lockInput=t},SET_ANSWER:function(e,t){var n=Object(re["a"])(t,2),c=n[0],a=n[1];r["a"].set(e.messages[c],"answer",a)},SET_NAME:function(e,t){e.name=t},LOADER_SHOW:function(e){e.loading=!0},LOADER_HIDE:function(e){e.loading=!1}},actions:{setAnswer:function(e,t){var n=e.commit,r=e.dispatch,c=e.state,a=Object(re["a"])(t,2),s=a[0],i=a[1];c.messages.forEach((function(e,t){e.id===s.id&&(n("SET_ANSWER",[t,i]),r("scroll"))}))},setVariable:function(e,t){var n=e.commit;n("LOCK_INPUT",!0),n("SET_VARIABLE",t)},nextMessage:function(e){var t=e.commit,n=e.dispatch,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=Object(re["a"])(r,5),a=c[0],s=c[1],i=c[2],o=c[3],l=c[4];t("LOADER_SHOW"),t("NEXT_MESSAGE_URL",[o,l]),n("setAnswer",[a,i]),setTimeout((function(){return n("DOWNLOAD_MESSAGE_FROM_API",[o,l])}),1e3),s.name&&(t("SET_VARIABLE",s),t("LOCK_INPUT",!0))},DOWNLOAD_MESSAGE_FROM_API:function(e,t){var n=e.commit,c=e.dispatch,a=e.state,s=Object(re["a"])(t,2),i=s[0],o=void 0===i?a.anchor:i,l=s[1],u=void 0===l?"anchor":l;n("NEXT_MESSAGE_URL",[o,u]);var p="https://crm-pro.ru/new/sbc/type/vk/get_data.php?method=main&id=".concat(a.user_id,"&p=").concat(a[u]);return a.role&&"anchor"===a.action&&(p="https://crm-pro.ru/new/sbc/type/vk/get_data.php?method=page&id=".concat(a.user_id,"&p=").concat(a.role,"&l=").concat(o)),ae()(p,{method:"GET"}).then((function(e){var t=e.data;return r["a"].set(t,"answer",null),t.variable.name&&n("LOCK_INPUT",!1),t.text.includes(a.variable)&&(t.text=t.text.replace(a.variable,a[a.variable])),n("SET_MESSAGES_TO_STATE",t),t})).then((function(){n("LOADER_HIDE"),c("scroll")})).catch((function(){return n("LOADER_HIDE")}))},scroll:function(){var e=document.querySelector(".container-scrollable"),t=document.querySelector(".screen-list");setTimeout((function(){return e.scrollTop=t.scrollHeight}),50)}},getters:{GET_MESSAGES:function(e){return e.messages},VISIBLE:function(e){return e.messages[e.messages.length-1].visible},GET_ANSWER:function(e){return e.answer},PLACE_HOLDER:function(e){return e.placeholder},GET_MESSAGE:function(e){var t;return e.messages.forEach((function(e){e.variable.name&&(t=e)})),t},LOADING_ON:function(e){return e.loading},LOCK:function(e){return e.lockInput}}});r["a"].config.productionTip=!1,new r["a"]({store:se,render:function(e){return e(ne)}}).$mount("#app")},5746:function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("e332"),c=n.n(r);c.a},7785:function(e,t,n){"use strict";var r=n("5746"),c=n.n(r);c.a},b21f:function(e,t,n){"use strict";var r=n("18f2"),c=n.n(r);c.a},b804:function(e,t,n){},bdbb:function(e,t,n){"use strict";var r=n("1b05"),c=n.n(r);c.a},de01:function(e,t,n){},e332:function(e,t,n){}});
//# sourceMappingURL=app.f2560599.js.map