(function(t){function e(e){for(var r,s,i=e[0],o=e[1],u=e[2],p=0,f=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&f.push(c[s][0]),c[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var o=n[i];0!==c[o]&&(r=!1)}r&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},c={app:0},a=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=o;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"18f2":function(t,e,n){},"1b05":function(t,e,n){},"1ed9":function(t,e,n){"use strict";var r=n("de01"),c=n.n(r);c.a},"24bb":function(t,e,n){"use strict";var r=n("b804"),c=n.n(r);c.a},3645:function(t,e,n){"use strict";var r=n("3e33"),c=n.n(r);c.a},"3e33":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("the-wrapper",[n("screen-list"),n("transition",[n("v-loader")],1)],1)],1)},a=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"container"},[n("screen-list")],1)])},i=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"screen-list-container"},[n("div",{staticClass:"container-scrollable"},[n("ul",{staticClass:"screen-list"},t._l(t.SCREENS,(function(t,e){return n("screen-item",{key:e,attrs:{screen:t,index:e}})})),1)]),n("v-input"),n("v-loader")],1)},u=[],l=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"screen"},[t.media?n("div",{staticClass:"screen-bg",class:[{"is-loading":t.loading},t.animClass]},[t.type_img?n("img",{attrs:{src:t.imgSrc}}):t.type_video?n("iframe",{staticClass:"screen-bg__video",staticStyle:{height:"34vmax"},attrs:{src:t.video_src,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}}):t._e()]):t._e(),t.msgOut?n("div",{key:t.screen.id,staticClass:"msg-box msg-question slide-right",style:t.customize},[n("div",{staticClass:"msg-inner",domProps:{innerHTML:t._s(t.msgOut)}})]):t._e(),t.buttons?n("div",{staticClass:"btn-group"},t._l(t.buttons,(function(e,r){return n("v-button",{key:r,staticClass:"slide-top",style:[e.customize,{animationDelay:120*r+"ms"}],attrs:{disabled:t.isClicked},domProps:{innerHTML:t._s(t.tagReplacer(e.text))},on:{click:function(n){return t.next(t.screen,e)}}})})),1):t._e(),t.screen.answer?n("div",{staticClass:"msg-box msg-answer slide-left"},[n("div",{staticClass:"msg-answer"},[n("div",{staticClass:"msg-inner",domProps:{innerHTML:t._s(t.screen.answer)}})])]):t._e()])},f=[],d=(n("7f7f"),n("6762"),n("2fdb"),n("a481"),n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"screen-btn",attrs:{type:"button"},on:{click:function(e){return t.$emit("click",e)}}},[n("span",[t._t("default")],2)])}),b=[],m={},g=m,O=(n("7785"),n("2877")),v=Object(O["a"])(g,d,b,!1,null,null,null),h=v.exports,_=n("2f62");function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={components:{VButton:h},props:{screen:Object,index:Number},data:function(){return{imgSrc:null,loading:!1,answer:null}},mounted:function(){this.imgLoading()},computed:{isClicked:function(){return this.$store.state.loading||this.screen.clicked},media:function(){return!!this.screen.attacment},video_src:function(){return"youtube"===this.screen.attacment.type?"https://www.youtube.com/embed/".concat(this.screen.attacment.data):"vimeo"===this.screen.attacment.type?"https://player.vimeo.com/video/".concat(this.screen.attacment.data):void 0},buttons:function(){return!!this.screen.buttons.length&&this.screen.buttons.map((function(t){return Object.assign(t,{customize:{background:"#".concat(t.customize.background),color:"#".concat(t.customize.color)}})}))},customize:function(){return{background:"#".concat(this.screen.customize.background),color:"#".concat(this.screen.customize.color)}},type_img:function(){return!!this.screen.attacment&&"image"===this.screen.attacment.type},type_video:function(){return!!this.screen.attacment&&"vimeo"===this.screen.attacment.type},msgOut:function(){var t=this.screen.text;return t=t.replace(/\n/gm,"<br>"),this.tagReplacer(t)},animClass:function(){return 0===this.index?"appear-tada":"appear"}},methods:j({},Object(_["b"])(["setAnswer","nextMessage","scroll","setVariable"]),{tagReplacer:function(t){if(t)return t.includes("[bold]")&&(t=t.replace("[bold]","<strong>").replace("[/bold]","</strong>")),t.includes("[em]")&&(t=t.replace("[em]","<em>").replace("[/em]","</em>")),t},next:function(t,e){var n=e.action,r=e[n],c=this.tagReplacer(e.text);"link"===n&&window.open(r);var a={name:e.variable.name,value:e.variable.value};this.nextMessage([t,a,c,r,n]),t.clicked=!0},imgLoading:function(){var t=this;if(!this.screen.attacment)return!1;this.loading=!0,this.imgSrc=this.screen.attacment.thumbnail,setTimeout((function(){t.imgSrc=t.screen.attacment.data,t.loading=!1}),400)}})},E=w,C=(n("b21f"),Object(O["a"])(E,p,f,!1,null,null,null)),S=C.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"msg-input",on:{keypress:function(e){return t.sendValue(e)}}},[n("div",{staticClass:"msg-icon-smile"},[n("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[n("g",[n("g",[n("path",{attrs:{d:"M256,0C114.848,0,0,114.848,0,256s114.848,256,256,256s256-114.848,256-256S397.152,0,256,0z M256,480\n\t\t\tC132.512,480,32,379.52,32,256S132.512,32,256,32s224,100.48,224,224S379.488,480,256,480z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M352,128c-35.296,0-64,28.704-64,64c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16c0-17.632,14.336-32,32-32\n\t\t\ts32,14.368,32,32c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16C416,156.704,387.296,128,352,128z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M160,128c-35.296,0-64,28.704-64,64c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16c0-17.632,14.336-32,32-32\n\t\t\ts32,14.368,32,32c0,8.832,7.168,16,16,16c8.832,0,16-7.168,16-16C224,156.704,195.296,128,160,128z"}})])]),n("g",[n("g",[n("path",{attrs:{d:"M438.016,294.336c-3.008-4-7.744-6.336-12.736-6.336H86.72c-4.992,0-9.728,2.336-12.736,6.336\n\t\t\tc-3.04,4-4,9.184-2.656,14.016C94.464,390.56,170.4,448,256,448s161.536-57.44,184.672-139.648\n\t\t\tC442.016,303.52,441.056,298.336,438.016,294.336z M256,416c-64.032,0-121.568-38.56-146.624-96h293.248\n\t\t\tC377.568,377.44,320.032,416,256,416z"}})])]),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g"),n("g")])]),n("div",{staticClass:"msg-input__field"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{type:"text",placeholder:"Введите сообщение",disabled:t.LOCK},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})]),n("button",{staticClass:"msg-input__btn",attrs:{disabled:t.LOCK},on:{click:function(e){return t.sendValue(e)}}},[n("svg",{attrs:{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"}},[n("path",{attrs:{fill:"#3b85f5","fill-opacity":"1",d:"M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"}})])])])},x=[];function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={props:{screenVariable:Object},data:function(){return{value:null}},watch:{LOCK:function(){var t=this;document.documentElement.clientHeight<768||this.LOCK||setTimeout((function(){return t.$refs.input.focus()}),200)}},computed:R({},Object(_["c"])(["LOCK","SCREEN_WITH_VARIABLE"])),methods:R({},Object(_["b"])(["nextMessage"]),{sendValue:function(t){if("click"===t.type||"keypress"===t.type&&13===t.keyCode){if(!this.value)return alert("Введите сообщение");if(this.value){var e=this.SCREEN_WITH_VARIABLE,n=this.value,r=e.variable.next,c="anchor",a={name:e.variable.name,value:this.value};this.nextMessage([e,a,n,r,c]),this.value=""}}}})},k=T,D=(n("bdbb"),Object(O["a"])(k,P,x,!1,null,null,null)),A=D.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.LOADING?n("div",{staticClass:"loader-row"},[t._m(0)]):t._e()},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"loader"},[n("li",{staticClass:"loader-inner-1"}),n("li",{staticClass:"loader-inner-2"}),n("li",{staticClass:"loader-inner-3"})])}];function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H={computed:z({},Object(_["c"])(["LOADING"]))},V=H,W=(n("3645"),Object(O["a"])(V,N,I,!1,null,null,null)),$=W.exports;function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){Object(l["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U={name:"ScreenList",components:{ScreenItem:S,VInput:A,VLoader:$},data:function(){return{}},mounted:function(){this.DOWNLOAD_SCREEN_FROM_API([])},computed:B({},Object(_["c"])(["SCREENS"])),methods:B({},Object(_["b"])(["DOWNLOAD_SCREEN_FROM_API","nextMessage"]))},F=U,G=(n("24bb"),Object(O["a"])(F,o,u,!1,null,null,null)),q=G.exports,X={name:"TheWrapper",components:{ScreenList:q}},J=X,Q=(n("1ed9"),Object(O["a"])(J,s,i,!1,null,null,null)),Y=Q.exports,Z={name:"app",components:{TheWrapper:Y,ScreenList:q,VLoader:$}},tt=Z,et=(n("5c0b"),Object(O["a"])(tt,c,a,!1,null,null,null)),nt=et.exports,rt=(n("7514"),n("8449"),n("768b")),ct=n("bc3a"),at=n.n(ct);r["a"].use(_["a"]);var st=new _["a"].Store({state:{lockInput:!0,placeholder:"Ваше сообщение",loading:!1,screens:[],anchor_global:"",user_id:"777-000987",anchor:"cinema",action:"",role:""},mutations:{SET_VARIABLE:function(t,e){t[e.name]=e.value,t.variable=e.name},NEXT_SCREEN_URL:function(t,e){var n=Object(rt["a"])(e,2),r=n[0],c=n[1];t[c]=r,t.action=c,"anchor"===c?t.anchor=r:"anchor_global"===c&&(t.anchor_global=r,t.role=t.anchor_global)},SET_ANCHOR:function(t,e){return t.anchor=e},SET_SCREEN_TO_STATE:function(t,e){t.screens.length<1?t.screens.push(e):t.screens.includes(e)||t.screens.push(e)},LOCK_INPUT:function(t,e){t.loading&&(t.lockInput=!0),t.lockInput=e},SET_ANSWER:function(t,e){var n=Object(rt["a"])(e,2),c=n[0],a=n[1];r["a"].set(t.screens[c],"answer",a)},LOADER_SHOW:function(t){t.loading=!0},LOADER_HIDE:function(t){t.loading=!1}},actions:{setAnswer:function(t,e){var n=t.commit,r=t.dispatch,c=t.state,a=Object(rt["a"])(e,2),s=a[0],i=a[1];c.screens.forEach((function(t,e){t.id===s.id&&(n("SET_ANSWER",[e,i]),r("scroll"))}))},nextMessage:function(t){var e=t.commit,n=t.dispatch,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=Object(rt["a"])(r,5),a=c[0],s=c[1],i=c[2],o=c[3],u=c[4];e("NEXT_SCREEN_URL",[o,u]),n("setAnswer",[a,i]),setTimeout((function(){return e("LOADER_SHOW")}),600),setTimeout((function(){return n("DOWNLOAD_SCREEN_FROM_API",[o,u])}),1e3),s.name&&(e("SET_VARIABLE",s),e("LOCK_INPUT",!0))},DOWNLOAD_SCREEN_FROM_API:function(t,e){var n=t.commit,c=t.dispatch,a=t.state,s=Object(rt["a"])(e,2),i=s[0],o=void 0===i?a.anchor:i,u=s[1],l=void 0===u?"anchor":u;n("LOADER_SHOW"),n("NEXT_SCREEN_URL",[o,l]);var p="https://crm-pro.ru/new/sbc/type/vk/get_data.php?method=main&id=".concat(a.user_id,"&p=").concat(a[l]);return a.role&&"anchor"===a.action&&(p="https://crm-pro.ru/new/sbc/type/vk/get_data.php?method=page&id=".concat(a.user_id,"&p=").concat(a.role,"&l=").concat(o)),at()(p,{method:"GET"}).then((function(t){if(t.data instanceof Object){var e=t.data;return r["a"].set(e,"answer",null),e.variable.name&&n("LOCK_INPUT",!1),e.text.includes(a.variable)&&(e.text=e.text.replace(a.variable,a[a.variable])),n("SET_SCREEN_TO_STATE",e),e}})).catch((function(){return n("LOCK_INPUT",!0)})).finally((function(){n("LOADER_HIDE"),c("scroll")}))},scroll:function(){var t=document.querySelector(".container-scrollable"),e=document.querySelector(".screen-list");setTimeout((function(){return t.scrollTop=e.scrollHeight}),50)}},getters:{SCREENS:function(t){return t.screens},SCREEN_WITH_VARIABLE:function(t){var e;return t.screens.find((function(t){t.variable.name&&(e=t)})),e},LOADING:function(t){return t.loading},LOCK:function(t){return t.lockInput}}});r["a"].config.productionTip=!1,new r["a"]({store:st,render:function(t){return t(nt)}}).$mount("#app")},5746:function(t,e,n){},"5c0b":function(t,e,n){"use strict";var r=n("e332"),c=n.n(r);c.a},7785:function(t,e,n){"use strict";var r=n("5746"),c=n.n(r);c.a},b21f:function(t,e,n){"use strict";var r=n("18f2"),c=n.n(r);c.a},b804:function(t,e,n){},bdbb:function(t,e,n){"use strict";var r=n("1b05"),c=n.n(r);c.a},de01:function(t,e,n){},e332:function(t,e,n){}});
//# sourceMappingURL=app.017c1330.js.map